{% extends "base.html" %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="section-title">–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
    <div>
        <span class="me-3">–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <strong>{{ admin_name }}</strong></span>
        <a href="/admin/admins" class="btn btn-modern me-2">üë• –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</a>
        <a href="/logout" class="btn btn-modern">üö™ –í—ã–π—Ç–∏</a>
    </div>
</div>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π -->
<div class="card-modern">
    <h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å</h4>
    <form method="POST" action="/admin/news/add" enctype="multipart/form-data">
        <input class="form-control mb-2" name="title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" required>
        <textarea class="form-control mb-2" name="text" placeholder="–¢–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏" required></textarea>
        <div class="mb-2">
            <label class="form-label">–ü—Ä–µ–≤—å—é (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)</label>
            <input class="form-control" type="file" name="preview" accept="image/*">
        </div>
        <button class="btn btn-modern">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å</button>
    </form>
</div>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤ -->
<div class="card-modern">
    <h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</h4>
    <form method="POST" action="/admin/player/add" id="playerForm">
        <input class="form-control mb-2" name="name" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞" required>
        
        <select name="role" class="form-control mb-2" id="roleSelect" required>
            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å --</option>
            <option value="goalie">–í—Ä–∞—Ç–∞—Ä—å</option>
            <option value="assistant">–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</option>
            <option value="sniper">–°–Ω–∞–π–ø–µ—Ä</option>
        </select>

        <div id="goalieFields" style="display: none;">
            <input type="number" class="form-control mb-2" name="goalie_goals" placeholder="–ì–æ–ª—ã" value="0" min="0">
            <input type="number" class="form-control mb-2" name="goalie_saves" placeholder="–û—Ç–±–∏—Ç—ã–µ" value="0" min="0">
            <input type="number" class="form-control mb-2" name="goalie_conceded" placeholder="–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ" value="0" min="0">
        </div>

        <div id="fieldPlayerFields" style="display: none;">
            <input type="number" class="form-control mb-2" name="field_goals" placeholder="–ì–æ–ª—ã" value="0" min="0">
            <input type="number" class="form-control mb-2" name="field_assists" placeholder="–ü–µ—Ä–µ–¥–∞—á–∏" value="0" min="0">
        </div>

        <textarea class="form-control mb-2" name="bio" placeholder="–ë–∏–æ–≥—Ä–∞—Ñ–∏—è / –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"></textarea>
        
        <button class="btn btn-modern">–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</button>
    </form>
</div>

<!-- –°–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–≥—Ä–æ–∫–æ–≤ -->
<div class="card-modern">
    <h4>üìã –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–≥—Ä–æ–∫–∏</h4>
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ò–º—è</th>
                    <th>–†–æ–ª—å</th>
                    <th>–ì–æ–ª—ã</th>
                    <th>–ü–µ—Ä–µ–¥–∞—á–∏</th>
                    <th>–û—Ç–±–∏—Ç—ã–µ</th>
                    <th>–ü—Ä–æ–ø—É—â–µ–Ω–æ</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for p in players %}
                <tr>
                    <td>{{ p[0] }}</td>
                    <td>{{ p[1] }}</td>
                    <td>
                        {% if p[2] == 'goalie' %}–í—Ä–∞—Ç–∞—Ä—å
                        {% elif p[2] == 'assistant' %}–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                        {% elif p[2] == 'sniper' %}–°–Ω–∞–π–ø–µ—Ä
                        {% endif %}
                    </td>
                    <td>{{ p[3] }}</td>
                    <td>{{ p[4] }}</td>
                    <td>{{ p[5] }}</td>
                    <td>{{ p[6] }}</td>
                    <td>
                        <a href="/edit_player/{{ p[0] }}" class="btn btn-sm btn-modern">‚úèÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –º–∞—Ç—á–µ–π -->
<div class="card-modern">
    <h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á</h4>
    <form method="POST" action="/admin/match/add">
        <div class="mb-3">
            <label class="form-label">–õ–µ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞</label>
            <select name="team_left" class="form-control" required>
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É --</option>
                {% for team in teams %}
                <option value="{{ team[0] }}">{{ team[1] }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">–ü—Ä–∞–≤–∞—è –∫–æ–º–∞–Ω–¥–∞</label>
            <select name="team_right" class="form-control" required>
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É --</option>
                {% for team in teams %}
                <option value="{{ team[0] }}">{{ team[1] }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">–°—á—ë—Ç</label>
            <input class="form-control" name="score" placeholder="5:2" required>
        </div>
        <div class="mb-3">
            <label class="form-label">–î–∞—Ç–∞</label>
            <input class="form-control" name="date" placeholder="2025-02-13" required>
        </div>
        <div class="mb-3">
            <label class="form-label">–ò—Å—Ö–æ–¥ (–¥–ª—è –Ω–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã)</label>
            <select name="result" class="form-control" required>
                <option value="win">–ü–æ–±–µ–¥–∞</option>
                <option value="loss">–ü–æ—Ä–∞–∂–µ–Ω–∏–µ</option>
                <option value="win_ot">–ü–æ–±–µ–¥–∞ (–û–¢)</option>
                <option value="loss_ot">–ü–æ—Ä–∞–∂–µ–Ω–∏–µ (–û–¢)</option>
            </select>
        </div>
        <button class="btn btn-modern">–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á</button>
    </form>
</div>

<!-- –§–æ—Ä–º–∞ –¥–ª—è —Ä–µ–ø–ª–µ–µ–≤ -->
<div class="card-modern">
    <h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–ø–ª–µ–π</h4>
    <form method="POST" action="/admin/replay/add" enctype="multipart/form-data">
        <input class="form-control mb-2" name="title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ø–ª–µ—è" required>
        <input class="form-control mb-2" type="file" name="replay_file" accept="video/*,.mcworld,.zip" required>
        <button class="btn btn-modern">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–ø–ª–µ–π</button>
    </form>
</div>

<script>
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
    const roleSelect = document.getElementById('roleSelect');
    const goalieFields = document.getElementById('goalieFields');
    const fieldPlayerFields = document.getElementById('fieldPlayerFields');

    function toggleFields() {
        const role = roleSelect.value;
        goalieFields.style.display = 'none';
        fieldPlayerFields.style.display = 'none';
        if (role === 'goalie') {
            goalieFields.style.display = 'block';
        } else if (role === 'assistant' || role === 'sniper') {
            fieldPlayerFields.style.display = 'block';
        }
    }

    roleSelect.addEventListener('change', toggleFields);
    toggleFields();
</script>
{% endblock %}